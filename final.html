<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>eafc9ffedae64b8ab0cb4040c3d235d6</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      word-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<div class="cell markdown">
<p>America's Top Sport: NFL Breakdown</p>
<p>Anish Vallabhaneni</p>
</div>
<div class="cell markdown" data-slideshow="{&quot;slide_type&quot;:&quot;fragment&quot;}">
<p>INTRODUCTION</p>
</div>
<div class="cell markdown">
<p>In modern society, two of the most popular activities for our generation are watching sports and gambling. Of all the sports in America specifically, the one that constantly gathers the most viewers is football. The NFL is a multi billion dollar industry and is one that also ends up being the most bet on sport in the United States as well. These bets come from a place of knowledge of the game, but with a better model they can be much more accurately predicted.</p>
<p>To create a model to predict the results of NFL games, I needed to use a website with plenty of data regarding the NFL. The company which I got this data from is Pro Football Focus. I interned at Pro Football Focus or PFF last summer and used their resources to get plenty of advanced data on the NFL. Not only do they have raw stats available, but they also present access to advanced statistics which can help make much more accurate predictions as well.</p>
<p>From PFF, I gathered the data by examining 6 CSV files, 3 for offense and 3 for defense. From there I went and tidied up the data by removing any unnecessary columns that would not be beneficial in getting stats to predict scores. The next step was to visualize the gathered data and choosing specific stats to let us understand what information we should feed to our machine learning model.</p>
<p>The final step in the project was to create the actual machine learning model that would allow me to predict these scores. By gathering stats from previous weeks, our machine learning model is able to predict scores for a certain week. The model will be taking offensive and defensive stats from both the home and away team and using that information to create score predictions.</p>
</div>
<div class="cell markdown">
<p>IMPORTS</p>
</div>
<div class="cell code">
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.formula.api <span class="im">as</span> smf</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scipy.stats <span class="im">as</span> stat</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sklearn.model_selection </span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeRegressor</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>header_row <span class="op">=</span> <span class="dv">0</span></span></code></pre></div>
</div>
<div class="cell markdown">
<p>PROCESSING AND READING DATA</p>
</div>
<div class="cell markdown">
<p>The three offensive CSVs are from Pro Football Focus Offensive Stats and the three defensive CSVs are from Pro Football Focus defensive stats. The specific stats are "Team Offense", "Passing Offense" and "Rushing Offense" along with "Team Defense", "Passing Defense" and "Rushing Defense". I believe that this information most effeciently can tell us how good a team is offensively or defensively which furthermore will indicate how well they perform</p>
</div>
<div class="cell code">
<div class="sourceCode" id="cb2"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>offense_stats <span class="op">=</span> pd.read_csv(<span class="st">&#39;offense_stats.csv&#39;</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>defense_stats <span class="op">=</span> pd.read_csv(<span class="st">&#39;defense_stats.csv&#39;</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>passing_stats <span class="op">=</span> pd.read_csv(<span class="st">&#39;passing_stats.csv&#39;</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>passdef_stats <span class="op">=</span> pd.read_csv(<span class="st">&#39;passdef_stats.csv&#39;</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>rushing_stats <span class="op">=</span> pd.read_csv(<span class="st">&#39;rushing_stats.csv&#39;</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>rushdef_stats <span class="op">=</span> pd.read_csv(<span class="st">&#39;rushdef_stats.csv&#39;</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>offense_stats.columns <span class="op">=</span> offense_stats.iloc[header_row]</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>offense_stats <span class="op">=</span> offense_stats.drop(header_row)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>defense_stats.columns <span class="op">=</span> defense_stats.iloc[header_row]</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>defense_stats <span class="op">=</span> defense_stats.drop(header_row)</span></code></pre></div>
</div>
<div class="cell markdown">
<p>TIDYING DATA</p>
</div>
<div class="cell markdown">
<p>After collecting all the initial data, it is neccessary to remove certain information that does not apply for our model. We can do that and are left with the important stats to base our model off of.</p>
</div>
<div class="cell code">
<div class="sourceCode" id="cb3"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>offense_stats <span class="op">=</span> pd.read_csv(<span class="st">&#39;offense_stats.csv&#39;</span>) <span class="co"># Offensive Stats</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>offense_stats.columns <span class="op">=</span> offense_stats.iloc[header_row]</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>offense_stats <span class="op">=</span> offense_stats.drop(header_row)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>offense_stats <span class="op">=</span> offense_stats.drop(columns<span class="op">=</span>[<span class="st">&#39;Pen&#39;</span>])</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>offense_stats <span class="op">=</span> offense_stats.drop(columns<span class="op">=</span>[<span class="st">&#39;TO%&#39;</span>])</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>offense_stats <span class="op">=</span> offense_stats.drop(columns<span class="op">=</span>[<span class="st">&#39;Sc%&#39;</span>])</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>offense_stats <span class="op">=</span> offense_stats.drop(columns<span class="op">=</span>[<span class="st">&#39;Rk&#39;</span>])</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>offense_stats <span class="op">=</span> offense_stats.drop(columns<span class="op">=</span>[<span class="st">&#39;1stPy&#39;</span>])</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>offense_stats <span class="op">=</span> offense_stats.iloc[: , :<span class="op">-</span><span class="dv">2</span>]</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>offense_stats <span class="op">=</span> offense_stats.drop(columns<span class="op">=</span>[<span class="st">&#39;1stD&#39;</span>])</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>offense_stats <span class="op">=</span> offense_stats.drop(columns<span class="op">=</span>[<span class="st">&#39;FL&#39;</span>])</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>offense_stats.columns <span class="op">=</span> [<span class="st">&#39;Team&#39;</span>, <span class="st">&#39;Games&#39;</span>,<span class="st">&#39;Total Points For&#39;</span>,<span class="st">&#39;Total Yards&#39;</span>, <span class="st">&#39;Total Plays&#39;</span>, <span class="st">&#39;Total Yards/Play&#39;</span>, <span class="st">&#39;Total Turnovers&#39;</span>, <span class="st">&#39;Passing Completions&#39;</span>, <span class="st">&#39;Passing Attempts&#39;</span>, <span class="st">&#39;Passing Yards&#39;</span>,<span class="op">\</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Passing TD&#39;</span>, <span class="st">&#39;Passing Int&#39;</span>, <span class="st">&#39;Net Yards/Attempt&#39;</span>, <span class="st">&#39;Rushing Attempts&#39;</span>, <span class="st">&#39;Total Rushing Yards&#39;</span>, <span class="st">&#39;Rushing TDs&#39;</span>, <span class="st">&#39;Yards/Attempt&#39;</span>]</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>offense_stats <span class="op">=</span> offense_stats.drop([<span class="dv">33</span>, <span class="dv">34</span>,<span class="dv">35</span>])</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>offense_stats <span class="op">=</span> offense_stats.sort_values(by<span class="op">=</span>[<span class="st">&#39;Team&#39;</span>]).reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>offense_stats.head()</span></code></pre></div>
</div>
<div class="cell markdown">
<p>I removed certain stats in order to prevent deviation in the model. Specifically, I removed penalties, rank, first downs, first down percentage, and fumbles lost. Furthermore, stats like turnover percentage and sack percentage were best fit by getting numbers from the opposing defense. The stats we focused on were: 'Team', 'Games', 'Total Points For', 'Total Yards', 'Total Plays', 'Total Yards/Play', 'Total Turnovers', 'Passing Completions', 'Passing Attempts', 'Passing Yards', 'Passing TD', 'Passing Int', 'Net Yards/Attempt', 'Rushing Attempts', 'Total Rushing Yards', 'Rushing TDs', 'Yards/Attempt'.</p>
</div>
<div class="cell code">
<div class="sourceCode" id="cb4"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>passing_stats <span class="op">=</span> pd.read_csv(<span class="st">&#39;passing_stats.csv&#39;</span>) <span class="co"># Passing Stats</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>passing_stats <span class="op">=</span> passing_stats.drop(columns<span class="op">=</span>[<span class="st">&#39;4QC&#39;</span>])</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>passing_stats <span class="op">=</span> passing_stats.drop(columns<span class="op">=</span>[<span class="st">&#39;GWD&#39;</span>])</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>passing_stats <span class="op">=</span> passing_stats.drop(columns<span class="op">=</span>[<span class="st">&#39;Sk%&#39;</span>])</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>passing_stats <span class="op">=</span> passing_stats.drop(columns<span class="op">=</span>[<span class="st">&#39;Rk&#39;</span>])</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>passing_stats <span class="op">=</span> passing_stats.drop(columns<span class="op">=</span>[<span class="st">&#39;EXP&#39;</span>])</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>passing_stats <span class="op">=</span> passing_stats.drop(columns<span class="op">=</span>[<span class="st">&#39;Yds.1&#39;</span>])</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>passing_stats <span class="op">=</span> passing_stats.drop(columns<span class="op">=</span>[<span class="st">&#39;Int%&#39;</span>])</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>passing_stats <span class="op">=</span> passing_stats.drop(columns<span class="op">=</span>[<span class="st">&#39;TD%&#39;</span>])</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>passing_stats <span class="op">=</span> passing_stats.drop(columns<span class="op">=</span>[<span class="st">&#39;Rate&#39;</span>])</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>passing_stats <span class="op">=</span> passing_stats.drop(columns<span class="op">=</span>[<span class="st">&#39;Sk&#39;</span>])</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>passing_stats <span class="op">=</span> passing_stats.drop(columns<span class="op">=</span>[<span class="st">&#39;Lng&#39;</span>])</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>passing_stats <span class="op">=</span> passing_stats.rename(columns<span class="op">=</span>{<span class="st">&quot;Tm&quot;</span>: <span class="st">&quot;Team&quot;</span>, <span class="st">&quot;G&quot;</span>: <span class="st">&quot;Games&quot;</span>, <span class="st">&quot;Ply&quot;</span>: <span class="st">&quot;Total Ply&quot;</span>, <span class="st">&quot;Y/P&quot;</span>:<span class="st">&quot;Total Y/P&quot;</span>, <span class="st">&#39;Cmp&#39;</span>:<span class="st">&#39;Completions&#39;</span>, <span class="st">&#39;Cmp%&#39;</span>:<span class="st">&#39;Completion %&#39;</span>})</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>passing_stats.rename(columns<span class="op">=</span>{passing_stats.columns[<span class="dv">5</span>]: <span class="st">&quot;Total Yards&quot;</span> }, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>passing_stats <span class="op">=</span> passing_stats.drop([<span class="dv">32</span>, <span class="dv">33</span>,<span class="dv">34</span>])</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>passing_stats <span class="op">=</span> passing_stats.sort_values(by<span class="op">=</span>[<span class="st">&#39;Team&#39;</span>]).reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>passing_stats.head()</span></code></pre></div>
</div>
<div class="cell markdown">
<p>Similar to passing stats, it is required we tidy up the rushing data. Stats such as longest run and experience have no bearing on how well a team will perform.</p>
</div>
<div class="cell code">
<div class="sourceCode" id="cb5"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>rushing_stats <span class="op">=</span> pd.read_csv(<span class="st">&#39;rushing_stats.csv&#39;</span>) </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>rushing_stats <span class="op">=</span> rushing_stats.drop(columns<span class="op">=</span>[<span class="st">&#39;Rk&#39;</span>])</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>rushing_stats <span class="op">=</span> rushing_stats.drop(columns<span class="op">=</span>[<span class="st">&#39;EXP&#39;</span>])</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>rushing_stats <span class="op">=</span> rushing_stats.drop(columns<span class="op">=</span>[<span class="st">&#39;Lng&#39;</span>])</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>rushing_stats <span class="op">=</span> rushing_stats.rename(columns<span class="op">=</span>{<span class="st">&quot;Tm&quot;</span>: <span class="st">&quot;Team&quot;</span>, <span class="st">&quot;G&quot;</span>: <span class="st">&quot;Games&quot;</span>})</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>rushing_stats.rename(columns<span class="op">=</span>{rushing_stats.columns[<span class="dv">3</span>]: <span class="st">&quot;Total Yards&quot;</span> }, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>rushing_stats <span class="op">=</span> rushing_stats.drop([<span class="dv">32</span>,<span class="dv">33</span>,<span class="dv">34</span>])</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>rushing_stats <span class="op">=</span> rushing_stats.sort_values(by<span class="op">=</span>[<span class="st">&#39;Team&#39;</span>]).reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>rushing_stats.head()</span></code></pre></div>
</div>
<div class="cell markdown">
<p>It is also neccesary that we tidy up defensive data. There are a plethora of defensive stats from the CSV and a vast majority of them are not needed for our model.</p>
</div>
<div class="cell code">
<div class="sourceCode" id="cb6"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>defense_stats <span class="op">=</span> pd.read_csv(<span class="st">&#39;defense_stats.csv&#39;</span>, index_col<span class="op">=</span><span class="va">False</span>) <span class="co"># Defensive Stats</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>defense_stats.columns <span class="op">=</span> defense_stats.iloc[header_row]</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>defense_stats <span class="op">=</span> defense_stats.drop(header_row)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>defense_stats <span class="op">=</span> defense_stats.drop(columns<span class="op">=</span> [<span class="st">&quot;FL&quot;</span>])</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>defense_stats <span class="op">=</span> defense_stats.drop(columns<span class="op">=</span> [<span class="st">&quot;1stD&quot;</span>])</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>defense_stats <span class="op">=</span> defense_stats.drop(columns<span class="op">=</span> [<span class="st">&quot;TO%&quot;</span>])</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>defense_stats <span class="op">=</span> defense_stats.drop(columns<span class="op">=</span> [<span class="st">&quot;Sc%&quot;</span>])</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>defense_stats <span class="op">=</span> defense_stats.drop(columns<span class="op">=</span> [<span class="st">&quot;EXP&quot;</span>])</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>defense_stats <span class="op">=</span> defense_stats.drop(columns<span class="op">=</span> [<span class="st">&quot;Pen&quot;</span>])</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>defense_stats <span class="op">=</span> defense_stats.drop(columns<span class="op">=</span> [<span class="st">&quot;1stPy&quot;</span>])</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>defense_stats <span class="op">=</span> defense_stats.drop(columns<span class="op">=</span> [<span class="st">&quot;Int&quot;</span>])</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>defense_stats <span class="op">=</span> defense_stats.drop(columns<span class="op">=</span> [<span class="st">&quot;TD&quot;</span>])</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>defense_stats <span class="op">=</span> defense_stats.drop(columns<span class="op">=</span> [<span class="st">&quot;Cmp&quot;</span>])</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>defense_stats <span class="op">=</span> defense_stats.drop(columns<span class="op">=</span> [<span class="st">&quot;Att&quot;</span>])</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="co"># defense_stats = defense_stats.drop(columns= defense_stats.columns[[16]], axis=1)</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>defense_stats <span class="op">=</span> defense_stats.iloc[:,<span class="op">~</span>defense_stats.columns.duplicated()]</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>defense_stats <span class="op">=</span> defense_stats.rename(columns<span class="op">=</span>{<span class="st">&quot;Tm&quot;</span>: <span class="st">&quot;Team&quot;</span>, <span class="st">&quot;G&quot;</span>: <span class="st">&quot;Games&quot;</span>, <span class="st">&quot;Yds&quot;</span>: <span class="st">&quot;Total Yards Allowed&quot;</span>, <span class="st">&quot;Ply&quot;</span>: <span class="st">&quot;Total Ply&quot;</span>, <span class="st">&quot;NY/P&quot;</span>:<span class="st">&quot;Net Yards per Pass Allowed&quot;</span>, <span class="st">&quot;Y/A&quot;</span>:<span class="st">&quot;Rushing Yards Allowed&quot;</span>\</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>    , <span class="st">&quot;TO&quot;</span>:<span class="st">&quot;Total TOs&quot;</span>, <span class="st">&quot;PA&quot;</span>:<span class="st">&quot;Points Allowed&quot;</span>})</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>defense_stats <span class="op">=</span> defense_stats.drop([<span class="dv">33</span>, <span class="dv">34</span>,<span class="dv">35</span>])</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>defense_stats <span class="op">=</span> defense_stats.sort_values(by<span class="op">=</span>[<span class="st">&#39;Team&#39;</span>]).reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>defense_stats.head()</span></code></pre></div>
</div>
<div class="cell markdown">
<p>Continuing with the tidying up of data we must individually move to pass defense data.</p>
</div>
<div class="cell code">
<div class="sourceCode" id="cb7"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>passdef_stats <span class="op">=</span> pd.read_csv(<span class="st">&#39;passdef_stats.csv&#39;</span>) <span class="co"># Passing Defense Stats</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>passdef_stats <span class="op">=</span> passdef_stats.drop(columns<span class="op">=</span> [<span class="st">&quot;Rk&quot;</span>])</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>passdef_stats <span class="op">=</span> passdef_stats.drop(columns<span class="op">=</span> [<span class="st">&quot;QBHits&quot;</span>])</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>passdef_stats <span class="op">=</span> passdef_stats.drop(columns<span class="op">=</span> [<span class="st">&quot;PD&quot;</span>])</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>passdef_stats <span class="op">=</span> passdef_stats.drop(columns<span class="op">=</span> [<span class="st">&quot;Rate&quot;</span>])</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>passdef_stats <span class="op">=</span> passdef_stats.drop(columns<span class="op">=</span> [<span class="st">&quot;Sk&quot;</span>])</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>passdef_stats <span class="op">=</span> passdef_stats.drop(columns<span class="op">=</span> [<span class="st">&quot;Yds.1&quot;</span>]) </span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>passdef_stats <span class="op">=</span> passdef_stats.drop(columns<span class="op">=</span> [<span class="st">&quot;TFL&quot;</span>])</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>passdef_stats <span class="op">=</span> passdef_stats.drop(columns<span class="op">=</span> [<span class="st">&quot;Sk%&quot;</span>])</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>passdef_stats <span class="op">=</span> passdef_stats.drop(columns<span class="op">=</span> [<span class="st">&quot;EXP&quot;</span>])</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>passdef_stats <span class="op">=</span> passdef_stats.drop([<span class="dv">32</span>,<span class="dv">33</span>, <span class="dv">34</span>])</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>passdef_stats <span class="op">=</span> passdef_stats.sort_values(by<span class="op">=</span>[<span class="st">&#39;Tm&#39;</span>]).reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>passdef_stats.head()</span></code></pre></div>
</div>
<div class="cell markdown">
<p>Finally, we must tidy our rushing defense data and remove unneccesary data points from this CSV as well.</p>
</div>
<div class="cell code">
<div class="sourceCode" id="cb8"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>rushdef_stats <span class="op">=</span> pd.read_csv(<span class="st">&#39;rushdef_stats.csv&#39;</span>) </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>rushdef_stats <span class="op">=</span> rushdef_stats.drop(columns<span class="op">=</span> [<span class="st">&quot;EXP&quot;</span>])</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>rushdef_stats <span class="op">=</span> rushdef_stats.drop(columns<span class="op">=</span> [<span class="st">&quot;Rk&quot;</span>])</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>rushdef_stats <span class="op">=</span> rushdef_stats.drop([<span class="dv">32</span>,<span class="dv">33</span>, <span class="dv">34</span>])</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>rushdef_stats <span class="op">=</span> rushdef_stats.sort_values(by<span class="op">=</span>[<span class="st">&#39;Tm&#39;</span>]).reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>rushdef_stats.head()</span></code></pre></div>
</div>
<div class="cell markdown">
<p>DATA ANALYSIS</p>
</div>
<div class="cell markdown">
<p>POINTS ALLOWED PER GAME VS POINTS SCORED PER GAME</p>
</div>
<div class="cell code">
<div class="sourceCode" id="cb9"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>offense_stats[<span class="st">&#39;Points Per Game&#39;</span>] <span class="op">=</span> offense_stats[<span class="st">&#39;Total Points For&#39;</span>].astype(<span class="bu">float</span>) <span class="op">/</span> offense_stats[<span class="st">&#39;Games&#39;</span>].astype(<span class="bu">float</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>ppg <span class="op">=</span> offense_stats[<span class="st">&#39;Points Per Game&#39;</span>]</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>defense_stats[<span class="st">&#39;Points Allowed Per Game&#39;</span>] <span class="op">=</span> defense_stats[<span class="st">&#39;Points Allowed&#39;</span>].astype(<span class="bu">float</span>) <span class="op">/</span> defense_stats[<span class="st">&#39;Games&#39;</span>].astype(<span class="bu">float</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>papg <span class="op">=</span> defense_stats[<span class="st">&#39;Points Allowed Per Game&#39;</span>]</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>plt.scatter(offense_stats[<span class="st">&#39;Points Per Game&#39;</span>], defense_stats[<span class="st">&#39;Points Allowed Per Game&#39;</span>])</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&quot;Points Per Game&quot;</span>)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&quot;Points Allowed Per Game&quot;</span>)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>m, b <span class="op">=</span> np.polyfit(offense_stats[<span class="st">&#39;Points Per Game&#39;</span>].head(<span class="dv">32</span>), defense_stats[<span class="st">&#39;Points Allowed Per Game&#39;</span>], <span class="dv">1</span>)</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>plt.plot(offense_stats[<span class="st">&#39;Points Per Game&#39;</span>], m<span class="op">*</span>offense_stats[<span class="st">&#39;Points Per Game&#39;</span>] <span class="op">+</span> b)</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, row <span class="kw">in</span> offense_stats.iterrows():</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    plt.annotate(row.Team, (ppg[i], papg[i]))</span></code></pre></div>
</div>
<div class="cell markdown">
<p>Our first visual breaks down how teams are performin in terms of scoring points vs allowing them. Teams in the bottom right of the chart are generally best as they are scoring the most points and allowing the least. Meanwhile, teams in the top left are generally the worst teams in the NFL as they allow opposing teams to score plenty of points while struggling to do so themselves.</p>
</div>
<div class="cell markdown">
<p>DEFENSIVE VS OFFENSIVE PASSING EFFICIENCY</p>
</div>
<div class="cell code">
<div class="sourceCode" id="cb10"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>passing_stats[<span class="st">&#39;Passing Efficiency&#39;</span>] <span class="op">=</span> ((passing_stats[<span class="st">&quot;Completion %&quot;</span>].astype(<span class="bu">float</span>) <span class="op">*</span> (passing_stats[<span class="st">&quot;Total Yards&quot;</span>].astype(<span class="bu">float</span>)<span class="op">/</span>passing_stats[<span class="st">&quot;Att&quot;</span>].astype(<span class="bu">float</span>))) <span class="op">+</span> <span class="op">\</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    (passing_stats[<span class="st">&quot;Completion %&quot;</span>].astype(<span class="bu">float</span>) <span class="op">*</span> (passing_stats[<span class="st">&quot;TD&quot;</span>].astype(<span class="bu">float</span>)<span class="op">/</span>passing_stats[<span class="st">&quot;Att&quot;</span>].astype(<span class="bu">float</span>))<span class="op">*</span><span class="dv">100</span><span class="op">*</span><span class="dv">6</span>) <span class="op">-</span> <span class="op">\</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    (passing_stats[<span class="st">&quot;Completion %&quot;</span>].astype(<span class="bu">float</span>) <span class="op">*</span> (passing_stats[<span class="st">&quot;Int&quot;</span>].astype(<span class="bu">float</span>)<span class="op">/</span>passing_stats[<span class="st">&quot;Att&quot;</span>].astype(<span class="bu">float</span>))<span class="op">*</span><span class="dv">100</span><span class="op">*</span><span class="dv">3</span>)) <span class="op">/</span> <span class="dv">100</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>passdef_stats[<span class="st">&#39;Defensive Passing Efficiency&#39;</span>] <span class="op">=</span> (passdef_stats[<span class="st">&quot;Int%&quot;</span>].astype(<span class="bu">float</span>))<span class="op">*</span><span class="dv">3</span> <span class="op">-</span> <span class="op">\</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    (passdef_stats[<span class="st">&quot;TD%&quot;</span>].astype(<span class="bu">float</span>)<span class="op">/</span>passing_stats[<span class="st">&quot;Att&quot;</span>].astype(<span class="bu">float</span>)<span class="op">*</span><span class="dv">100</span>)<span class="op">*</span>(<span class="dv">6</span>) <span class="op">-</span> <span class="op">\</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    (passdef_stats[<span class="st">&quot;Y/C&quot;</span>].astype(<span class="bu">float</span>)<span class="op">/</span>passing_stats[<span class="st">&quot;Att&quot;</span>].astype(<span class="bu">float</span>)<span class="op">*</span><span class="dv">100</span><span class="op">*</span><span class="dv">3</span>)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>plt.scatter(passing_stats[<span class="st">&#39;Passing Efficiency&#39;</span>], passdef_stats[<span class="st">&#39;Defensive Passing Efficiency&#39;</span>])</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&quot;Passing Efficiency&quot;</span>)</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&quot;Defensive Passing Efficiency&quot;</span>)</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>m, b <span class="op">=</span> np.polyfit(passing_stats[<span class="st">&#39;Passing Efficiency&#39;</span>].head(<span class="dv">32</span>), passdef_stats[<span class="st">&#39;Defensive Passing Efficiency&#39;</span>], <span class="dv">1</span>)</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>plt.plot(passing_stats[<span class="st">&#39;Passing Efficiency&#39;</span>], m<span class="op">*</span>passing_stats[<span class="st">&#39;Passing Efficiency&#39;</span>] <span class="op">+</span> b)</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, row <span class="kw">in</span> passing_stats.iterrows():</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>    plt.annotate(row.Team, (passing_stats[<span class="st">&#39;Passing Efficiency&#39;</span>][i], passdef_stats[<span class="st">&#39;Defensive Passing Efficiency&#39;</span>][i]))</span></code></pre></div>
</div>
<div class="cell markdown">
<p>The second visual breaks down how individually efficient each team's passing game is. Having a high Passing Efficiency tells us a team displays that a team is generally successful when passing the ball. Similarly, Defensiving Passing Efficiency displays a team's ability to stop opposing team's passing offense. Team's with a high passing defense efficiency are able to limit their opponents passing game success.</p>
</div>
<div class="cell markdown">
<p>DEFENSIVE VS OFFENSIVE RUSHING EFFICIENCY</p>
</div>
<div class="cell code">
<div class="sourceCode" id="cb11"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>rushing_stats[<span class="st">&#39;Rushing Efficiency&#39;</span>] <span class="op">=</span> (rushing_stats[<span class="st">&quot;Y/A&quot;</span>].astype(<span class="bu">float</span>))<span class="op">\</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>     <span class="op">+</span> (rushing_stats[<span class="st">&quot;TD&quot;</span>].astype(<span class="bu">float</span>) <span class="op">/</span>rushing_stats[<span class="st">&quot;Att&quot;</span>].astype(<span class="bu">float</span>)) <span class="op">*</span> <span class="dv">100</span><span class="op">*</span><span class="dv">6</span><span class="op">\</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>     <span class="op">-</span> (rushing_stats[<span class="st">&quot;Fmb&quot;</span>].astype(<span class="bu">float</span>) <span class="op">/</span>rushing_stats[<span class="st">&quot;Att&quot;</span>].astype(<span class="bu">float</span>)) <span class="op">*</span> <span class="dv">100</span><span class="op">*</span><span class="dv">3</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>rushdef_stats[<span class="st">&#39;Defensive Rushing Efficiency&#39;</span>] <span class="op">=</span> (rushdef_stats[<span class="st">&quot;Y/A&quot;</span>].astype(<span class="bu">float</span>)) <span class="op">-</span> ((rushdef_stats[<span class="st">&quot;TD&quot;</span>].astype(<span class="bu">float</span>) <span class="op">/</span>rushdef_stats[<span class="st">&quot;Att&quot;</span>].astype(<span class="bu">float</span>)) <span class="op">*</span> <span class="dv">100</span>)<span class="op">*</span><span class="dv">6</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>plt.scatter(rushing_stats[<span class="st">&#39;Rushing Efficiency&#39;</span>], rushdef_stats[<span class="st">&#39;Defensive Rushing Efficiency&#39;</span>])</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&quot;Rushing Efficiency&quot;</span>)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&quot;Defensive Rushing Efficiency&quot;</span>)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>m, b <span class="op">=</span> np.polyfit(rushing_stats[<span class="st">&#39;Rushing Efficiency&#39;</span>].head(<span class="dv">32</span>), rushdef_stats[<span class="st">&#39;Defensive Rushing Efficiency&#39;</span>], <span class="dv">1</span>)</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>plt.plot(rushing_stats[<span class="st">&#39;Rushing Efficiency&#39;</span>], m<span class="op">*</span>rushing_stats[<span class="st">&#39;Rushing Efficiency&#39;</span>] <span class="op">+</span> b)</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, row <span class="kw">in</span> rushing_stats.iterrows():</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    plt.annotate(row.Team, (rushing_stats[<span class="st">&#39;Rushing Efficiency&#39;</span>][i], rushdef_stats[<span class="st">&#39;Defensive Rushing Efficiency&#39;</span>][i]))</span></code></pre></div>
</div>
<div class="cell markdown">
<p>This visual operates very similarly to the last one except it is focused on rushing efficiency. It compares every team to the mean in both offensive and defensive rushing efficiency and displays it through a chart.</p>
</div>
<div class="cell markdown">
<p>TYPE OF PLAYS RUN</p>
</div>
<div class="cell code">
<div class="sourceCode" id="cb12"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run vs Pass</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>offense_stats[<span class="st">&#39;Total Plays(Only Run and Pass&#39;</span>] <span class="op">=</span> offense_stats[<span class="st">&#39;Passing Attempts&#39;</span>].astype(<span class="bu">float</span>) <span class="op">+</span> offense_stats[<span class="st">&#39;Rushing Attempts&#39;</span>].astype(<span class="bu">float</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>offense_stats[<span class="st">&#39;Pass Percent&#39;</span>] <span class="op">=</span> offense_stats[<span class="st">&#39;Passing Attempts&#39;</span>].astype(<span class="bu">float</span>)<span class="op">/</span>offense_stats[<span class="st">&#39;Total Plays(Only Run and Pass&#39;</span>].astype(<span class="bu">float</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>offense_stats[<span class="st">&#39;Run Percent&#39;</span>] <span class="op">=</span> offense_stats[<span class="st">&#39;Rushing Attempts&#39;</span>].astype(<span class="bu">float</span>)<span class="op">/</span>offense_stats[<span class="st">&#39;Total Plays(Only Run and Pass&#39;</span>].astype(<span class="bu">float</span>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>plt.scatter(offense_stats[<span class="st">&#39;Pass Percent&#39;</span>], offense_stats[<span class="st">&#39;Run Percent&#39;</span>])</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&quot;Pass Percent&quot;</span>)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&quot;Run Percent&quot;</span>)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>m, b <span class="op">=</span> np.polyfit(offense_stats[<span class="st">&#39;Pass Percent&#39;</span>].head(<span class="dv">32</span>), offense_stats[<span class="st">&#39;Run Percent&#39;</span>], <span class="dv">1</span>)</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>plt.plot(offense_stats[<span class="st">&#39;Pass Percent&#39;</span>], m<span class="op">*</span>offense_stats[<span class="st">&#39;Pass Percent&#39;</span>] <span class="op">+</span> b)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, row <span class="kw">in</span> offense_stats.iterrows():</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>    plt.annotate(row.Team, (offense_stats[<span class="st">&#39;Pass Percent&#39;</span>][i], offense_stats[<span class="st">&#39;Run Percent&#39;</span>][i]))</span></code></pre></div>
</div>
<div class="cell markdown">
<p>This visual serves as more of a determinant of what type of plays teams are running. It breaks down the frequency at which teams pass or run and puts it on a chart. It may be surprising to some that the visual displayed is a line, but every play must be a pass or run which shows that teams that pass more must run less and teams that run more must also pass less.</p>
</div>
<div class="cell markdown">
<p>MODEL PREDICTIONS</p>
</div>
<div class="cell markdown">
<p>TEAM PLAY STYLE</p>
</div>
<div class="cell code">
<div class="sourceCode" id="cb13"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(offense_stats[<span class="st">&#39;Team&#39;</span>])</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;RushPercent&#39;</span>] <span class="op">=</span> offense_stats[<span class="st">&#39;Run Percent&#39;</span>]</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;RushEfficiency&#39;</span>] <span class="op">=</span> rushing_stats[<span class="st">&#39;Rushing Efficiency&#39;</span>]</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;PassPercent&#39;</span>] <span class="op">=</span> offense_stats[<span class="st">&#39;Pass Percent&#39;</span>]</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;PassEfficiency&#39;</span>] <span class="op">=</span> passing_stats[<span class="st">&#39;Passing Efficiency&#39;</span>]</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;DRushEfficiency&#39;</span>] <span class="op">=</span> rushdef_stats[<span class="st">&#39;Defensive Rushing Efficiency&#39;</span>]</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;DPassEfficiency&#39;</span>] <span class="op">=</span> passdef_stats[<span class="st">&#39;Defensive Passing Efficiency&#39;</span>]</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;DefenseRank&#39;</span>] <span class="op">=</span> defense_stats[<span class="st">&#39;Rk&#39;</span>]</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;OffensiveTO%&#39;</span>] <span class="op">=</span> offense_stats[<span class="st">&#39;Total Turnovers&#39;</span>].astype(<span class="bu">float</span>)<span class="op">/</span>offense_stats[<span class="st">&#39;Total Plays&#39;</span>].astype(<span class="bu">float</span>)</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;DefensiveTO%&#39;</span>] <span class="op">=</span> defense_stats[<span class="st">&#39;Total TOs&#39;</span>].astype(<span class="bu">float</span>)<span class="op">/</span>defense_stats[<span class="st">&#39;Total Ply&#39;</span>].astype(<span class="bu">float</span>)</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>df.insert(<span class="dv">10</span>, <span class="st">&quot;Value&quot;</span>, <span class="dv">1</span>)</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>df.head()</span></code></pre></div>
</div>
<div class="cell markdown">
<p>This dataframe displays information about how often teams run and pass along with their efficiency agaisnt both of them. It will serve as an important element of our model's ability to create predictions.</p>
</div>
<div class="cell markdown">
<p>MODEL FORMULA</p>
</div>
<div class="cell markdown">
<p>The most important part of the model is creating an effective formula to project the results of each game. By using efficiency numbers along with projecting the likelihood of a turnover we can make an effective formula.</p>
<p>The formula I created was: (Pass Percent * Pass Efficiency)) - (Pass Percent * PassDef Efficiency) + ((Rush Percent * Rush Efficiency) - ((Rush Percent * RushDef Efficiency) - (rank * (Offensive Turnover% - Defensive Turnover%) + 1.0)</p>
<p>The formula uses both rushing and passing efficiency and rate on both the offensive and defensive side. By adding turnover probability to the formula, I believe we can create some form of predictions for NFL games</p>
</div>
<div class="cell code">
<div class="sourceCode" id="cb14"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;Value&#39;</span>] <span class="op">=</span> ((df[<span class="st">&#39;RushPercent&#39;</span>] <span class="op">*</span> df[<span class="st">&#39;RushEfficiency&#39;</span>]) <span class="op">+</span> (df[<span class="st">&#39;PassPercent&#39;</span>] <span class="op">*</span> df[<span class="st">&#39;PassEfficiency&#39;</span>])) <span class="op">-</span> ((df[<span class="st">&#39;RushPercent&#39;</span>] <span class="op">*</span> df[<span class="st">&#39;DRushEfficiency&#39;</span>]) <span class="op">-</span> (df[<span class="st">&#39;PassPercent&#39;</span>] <span class="op">*</span> df[<span class="st">&#39;DPassEfficiency&#39;</span>])) <span class="op">-</span> (df[<span class="st">&#39;DefenseRank&#39;</span>].astype(<span class="bu">float</span>) <span class="op">*</span> (df[<span class="st">&#39;OffensiveTO%&#39;</span>] <span class="op">-</span> df[<span class="st">&#39;DefensiveTO%&#39;</span>]) <span class="op">+</span> <span class="fl">1.0</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>df</span></code></pre></div>
</div>
<div class="cell markdown">
<p>WIN PROBABILITY</p>
</div>
<div class="cell code">
<div class="sourceCode" id="cb15"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>new_df <span class="op">=</span> pd.DataFrame()</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>i <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(df.Team.unique())):</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    arr <span class="op">=</span> []</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> index2 <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(df.Team.unique())):</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>        total <span class="op">=</span> df[<span class="st">&quot;Value&quot;</span>][index]<span class="op">+</span>df[<span class="st">&quot;Value&quot;</span>][index2]</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>        arr.append(df[<span class="st">&quot;Value&quot;</span>][index]<span class="op">/</span>total)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    new_df <span class="op">=</span> new_df.append(pd.DataFrame([arr]))</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>new_df.columns <span class="op">=</span> df.Team.unique()</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>new_df.index <span class="op">=</span> df.Team.unique()</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>new_df</span></code></pre></div>
</div>
<div class="cell markdown">
<p>This data represents each team's chances of beating one another. With this data we can make a chart which plots the information and displays which teams are the most likely to win or lose</p>
</div>
<div class="cell code">
<div class="sourceCode" id="cb16"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.pyplot <span class="im">import</span> figure</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>figure(figsize<span class="op">=</span>(<span class="dv">32</span>, <span class="dv">16</span>), dpi<span class="op">=</span><span class="dv">80</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(df.Team.unique())):</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    plt.plot(df.Team.unique(), new_df.iloc[i], label <span class="op">=</span> df.Team[i])</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Winning Percentage Against Team&#39;</span>)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Team&#39;</span>)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Winning Percent&#39;</span>)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>plt.legend()</span></code></pre></div>
</div>
<div class="cell markdown">
<p>LEAST SQUARES REGRESSION</p>
</div>
<div class="cell markdown">
<p>GETTING TRAINING DATA</p>
</div>
<div class="cell markdown">
<p>To perform our least squares regression, the first thing we must do is split up training and test data. 75 percent of our data will serve as training while the other 25 percent will serve as test data.</p>
</div>
<div class="cell code">
<div class="sourceCode" id="cb17"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> df.drop(columns<span class="op">=</span>[<span class="st">&#39;Value&#39;</span>, <span class="st">&#39;Team&#39;</span>], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> df[<span class="st">&#39;Value&#39;</span>]</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>X_train, X_test, Y_train, Y_test <span class="op">=</span> train_test_split(X, Y, test_size<span class="op">=</span><span class="fl">.25</span>, random_state<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>X_train[<span class="st">&#39;Value&#39;</span>] <span class="op">=</span> Y_train</span></code></pre></div>
</div>
<div class="cell markdown">
<p>REGRESSION</p>
</div>
<div class="cell markdown">
<p>Using our previously created formula and passing it into an OLS function we can create a Least Squares Regression Model with our training data.</p>
</div>
<div class="cell code">
<div class="sourceCode" id="cb18"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.formula.api <span class="im">import</span> ols</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>formula_str <span class="op">=</span> <span class="st">&quot;Value ~ ((RushPercent * RushEfficiency) + (PassPercent * PassEfficiency)) - ((RushPercent * DRushEfficiency) - (PassPercent * DPassEfficiency)) - (DefenseRank * (OffensiveTO% - DefensiveTO%))&quot;</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>mod <span class="op">=</span> ols(formula<span class="op">=</span>formula_str, data<span class="op">=</span>X_train).fit()</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">&#39;ignore&#39;</span>)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>mod.summary()</span></code></pre></div>
</div>
<div class="cell markdown">
<p>The R^2 value indicates how much of the variation in the value can be explained by variation in the columns (Rush Efficiency, Rush Percent, etc.). If we predict our test values, how would they come out?</p>
</div>
<div class="cell markdown">
<p>CONCLUSION</p>
</div>
<div class="cell markdown">
<p>The model that I created is based on the general information on how effeciently teams operate on offense and defense along with the type of plays they call and their turnover rates. On an actual football field there are much more factors at play. Injuries and matchups are a huge factor in picking games and mean a lot more then simply ranking teams based on these efficiency numbers.</p>
<p>With my current knowledge of computer science this model did an effective job of creating a basic representation of football games to an NFL fan. On a large scale of being consistently accurate to a bettor however it does not do an excellent job.</p>
<p>To create a more effecient model and improve on this it is neccesary to understand all of the various little factors at play in the NFL. Furthermore, each factor also carries a different weight and I would need to look through historical and current data to determine how much each factor matters.</p>
<p>Football is also a week to week game where anyone can always upset any other team. No model will ever be perfectly accurate but in a game where one play can be all the difference there is an even greater amount of variance. Regardless, after this class is over I will attempt to make this model more advanced and be the individual who takes down gambling empires in finding a way to beat the odds.</p>
</div>
</body>
</html>
